import{d as r,j as d,L as g,a7 as x}from"./app-297e02ac.js";import{F as f,E as u}from"./index-9f59e246.js";import{F as j}from"./index-84049355.js";import{L as v}from"./index-9c54aa32.js";import{P as b,B as h}from"./index-c325659d.js";const L=e=>{if(e.files&&e.files[0]){const t=e.files[0],i=new FileReader;i.onload=function(n){document.getElementById(`embed-${e.name}`).style.backgroundImage=`url('${n.target.result}')`,document.getElementById(`embed-${e.name}`).style.backgroundSize="cover",document.getElementById(`embed-${e.name}`).querySelector(".file-selected").innerHTML=t.name},i.readAsDataURL(t)}},M=e=>t=>{t.preventDefault(),e.edit?e.patch(e.match.params.id,t.target):e.post(t.target)},N=({props:e,resource:t})=>{const{auth:{role:i,data:n}}=e;if(i==="user"){const l=n.role.features.find(a=>a.prefix===t.split("_").join("-"));return l&&JSON.parse(l.permissions).includes(e.edit?"u":"c")?null:d(x,{to:"/user/dashboard"})}return null},R={component:{saveAddHandler:(e,t)=>()=>e({add:!0},()=>t.post(document.querySelector("form"))),inputChangeHandler:(e,t)=>i=>{const{name:n,value:l,files:a}=i.target;if(a&&L(i.target),n.includes("[")){const{translate:c}=e,s=n.split("[")[0],m=e[s];return m[c]=l,t({[s]:m})}t({[n]:a?a[0]:l})},fileUpload:e=>document.getElementById(e).click()},lifecycle:{componentDidMount:(e,t)=>{e.reset(),e.edit?e.get(e.match.params.id):e.info&&e.info(),t({isMounted:!0})},componentDidUpdate:(e,t)=>(i,n,l,a,c)=>{if(!i.backend[e].message&&n.backend[e].message&&n.backend[e].message.type==="success"&&!n.edit&&(l.add?c():n.history.push({pathname:`/${n.auth.role}/${e.split("_").join("-")}`,state:{message:n.backend[e].message}})),!i.backend[e][t]&&n.backend[e][t]||n.edit&&!i.backend[e].message&&n.backend[e].message&&n.backend[e].message.type==="success"){const{backend:{[e]:{[t]:s}}}=n;a({...s})}},render:({className:e,props:t,state:i,resource:n,children:l})=>{const{content:{cms:{pages:{backend:{pages:{[n]:a}}}}},backend:{[n]:{loading:c,error:s,message:m}},auth:{role:o}}=t;return i.isMounted||(document.title=`${t.edit?a.edit:a.add} | ${document.head.querySelector('meta[name="base-title"]').content}`),r("div",{className:e,children:[d(b,{title:a.title,subtitle:t.edit?a.edit:a.add,icon:a.icon,children:d(h,{items:t.edit&&[{to:`/${o}/${n.split("_").join("-")}`,content:a.index}],main:t.edit?a.edit:a.add})}),d(g,{loading:i.isMounted&&c,isAuthenticated:!0,children:r("div",{className:"content",children:[d(N,{props:t,resource:n}),d(f,{message:m}),d(u,{err:s}),d(j,{onSubmit:M(t),icon:a.icon,title:t.edit?a.edit:a.add,list:a.index,link:`/${o}/${n.split("_").join("-")}`,innerClassName:"row justify-content-center",children:l})]})})]})}}},_={lifecycle:{render:({className:e,props:t,state:i,resource:n,data:l,fields:a})=>{const{content:{cms:{pages:{backend:{pages:{[n]:c}}}}},backend:{[n]:{loading:s,error:m,message:o,[n]:k=[],total:y}},auth:{role:$}}=t;return i.isMounted||(document.title=`${c.index} | ${document.head.querySelector('meta[name="base-title"]').content}`),r("div",{className:e,children:[d(b,{title:c.title,subtitle:c.index,icon:c.icon,children:d(h,{main:c.index})}),d(g,{loading:i.isMounted&&s,isAuthenticated:!0,children:r("div",{className:"content",children:[d(u,{err:m}),t.location.state?d(f,{time:5e3,message:t.location.state.message}):null,d(f,{message:o}),d(v,{array:l,loading:s,data:JSON.stringify(k),get:t.get,total:y,bordered:!0,add:c.add,link:`/${$}/${n.split("_").join("-")}/add`,icon:c.icon,title:c.index,className:"shadow-sm",fields:a})]})})]})}}};export{R as a,_ as i};
//# sourceMappingURL=utility-d8d0b0df.js.map
