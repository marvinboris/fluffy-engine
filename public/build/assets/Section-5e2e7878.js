var x=Object.defineProperty;var S=(n,a,t)=>a in n?x(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t;var P=(n,a,t)=>(S(n,typeof a!="symbol"?a+"":a,t),t);import{r as M,m as I,j as s,d as b,n as k,w as R,b as F,u as L,L as A}from"./app-1ba2be60.js";import{F as _,E as T}from"./index-e75d3adc.js";import{F as E}from"./index-6c7f4053.js";import{P as H,B as K}from"./index-034081ef.js";import{I as D,F as V}from"./index-2d9652c7.js";import{L as B}from"./Label-80653cbd.js";import{g as W,p as Y,r as q}from"./cms-0e385d4c.js";const j=(n,a,t,c,i,h=[],u=[])=>Object.keys(n).map(l=>{const d=n[l],m=`${a}[${l}]`,C=`${t}-${l}`,f=c[l],v=i.concat(l);let w;const g=h.find(r=>new RegExp(r.regex.replace(/\[/g,"\\[").replace(/\]/g,"\\]")).test(m));w=g?g.action(d):null;let e;const o=u.find(r=>new RegExp(r.regex.replace(/\[/g,"\\[").replace(/\]/g,"\\]")).test(m));return e=o?o.action(d):null,typeof d=="string"?b(M.Fragment,{children:[w,b(V,{className:"col-md-6 col-lg-4",children:[s(B,{className:"text-small text-500 text-truncate w-100",children:k(d)}),s(D,{type:"textarea",name:m,id:C,placeholder:k(d),defaultValue:f,inputClassName:`scrollbar-${window.APP_PRIMARY_COLOR}`},`${Math.random()+m}-input`)]}),e]},Math.random()+m):j(d,m,C,f,v,h,u)}),z=({cmsExample:n,cmsValue:a,language:t,part:c})=>{const[i,h]=M.useState(`${t.abbr}-${Object.keys(n).sort()[0]}`),u=Object.keys(a).map(e=>{let o=I.capitalize(e.split("_").join(" "));return Object.keys(n.pages).find(r=>r===e)&&(o=`Page - ${o}`),{key:e,name:o}}).sort((e,o)=>e.name.localeCompare(o.name)).map(({key:e,name:o})=>{const r=`${t.abbr}-${e}`;return s("option",{value:r,children:o},r)}),l=`${t.abbr}[${c}]`,d=`${t.abbr}-${c}`,m=(e,o=[],r=[])=>{const O=n[e],p=`${l}[${e}]`,$=`${d}-${e}`,N=a[e];return j(O,p,$,N,[e],o,r)},f=Object.keys(n).filter(e=>e!=="pages").map(e=>s("div",{className:`row pt-4${`${t.abbr}-${e}`===i?"":" d-none"}`,children:m(e)},`${Math.random()}${l}[${e}]`)),v=(e,o=[],r=[])=>{const O=n.pages[e],p=`${l}[pages][${e}]`,$=`${d}-pages-${e}`,N=a[e];return j(O,p,$,N,[e],o,r)},g=Object.keys(n.pages).map(e=>s("div",{className:`row pt-4${`${t.abbr}-${e}`===i?"":" d-none"}`,children:v(e)},`${Math.random()}${l}[pages][${e}]`));return b(M.Fragment,{children:[s("div",{className:"row",children:s("div",{className:"col-md-4",children:s(D,{type:"select",name:"section",label:"Section",onChange:e=>h(e.target.value),value:i,validation:null,children:u})})}),s("hr",{}),b("div",{children:[f,g]})]},`Language-${t.abbr}`)};class G extends M.Component{constructor(){super(...arguments);P(this,"state",{abbr:"en",isMounted:!1});P(this,"submitHandler",async t=>{t.preventDefault(),await this.props.patch(this.props.name,t.target)});P(this,"inputChangeHandler",t=>{const{name:c,value:i,files:h}=t.target;this.setState({[c]:h?h[0]:i})})}static getDerivedStateFromProps(t,c){if(t.backend.cms.cms&&c.app_name===""){const{backend:{cms:{cms:{[t.name]:i}}}}=t;return L(c,{...i})}return c}async componentDidMount(){this.props.reset(),this.props.get(),this.setState({isMounted:!0})}componentWillUnmount(){this.props.reset()}render(){const{name:t,content:{cms:{pages:{backend:{components:{form:{save:c}},pages:{cms:{icon:i,title:h,[t]:u}}}}}},backend:{cms:{loading:l,error:d,message:m,cmsExample:C,cms:f,languages:v=[]}},auth:{role:w}}=this.props,{abbr:g}=this.state;this.state.isMounted||(document.title=`${this.props.content.cms.pages.backend.sidebar.menu.cms[t]} | ${document.head.querySelector('meta[name="base-title"]').content}`);const e=s(T,{err:d}),o=v.map(p=>s("option",{value:p.abbr,children:p.name},Math.random()+JSON.stringify(p))),r=v.map(p=>{const $=f.pages[p.abbr][t],N={...$.pages};return Object.keys($).filter(y=>y!=="pages").forEach(y=>N[y]=$[y]),s("div",{className:p.abbr===g?"":"d-none",children:s(z,{cmsExample:C.pages.en[t],cmsValue:N,language:p,part:t})},Math.random())}),O=b("div",{children:[s(_,{message:m}),s("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),s("div",{className:"row",children:s("div",{className:"col-md-4",children:s(D,{type:"select",name:"abbr",label:"Lang",onChange:this.inputChangeHandler,value:g,validation:null,children:o})})}),s("div",{children:r}),s("div",{style:{marginTop:40},children:b("button",{className:`btn btn-${window.APP_PRIMARY_COLOR}`,children:[c,s("i",{className:"fas fa-save"})]})})]});return b("div",{className:`Cms ${this.props.className||""}`,children:[s(H,{title:h,subtitle:u,icon:i,children:s(K,{main:u})}),s(A,{loading:this.state.isMounted&&l,isAuthenticated:!0,children:b("div",{className:"content",children:[e,s(E,{onSubmit:this.submitHandler,icon:i,title:u,link:`/${w}/cms`,innerClassName:"row",children:O})]})})]})}}const J=n=>({...n}),U=n=>({get:()=>n(W()),patch:(a,t)=>n(Y(a,t)),reset:()=>n(q())}),oe=R(F(J,U)(G));export{oe as S};
//# sourceMappingURL=Section-5e2e7878.js.map
