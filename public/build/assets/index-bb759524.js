var W=Object.defineProperty;var Y=(h,p,a)=>p in h?W(h,p,{enumerable:!0,configurable:!0,writable:!0,value:a}):h[p]=a;var o=(h,p,a)=>(Y(h,typeof p!="symbol"?p+"":p,a),a);import{b as q,r as G,j as e,u as J,d as t,F as w,ax as K,ay as Q,az as V,af as X}from"./app-1ba2be60.js";import{B as Z}from"./Table-72362a8f.js";import{I as T}from"./Input-6b5811e7.js";let y;class ee extends G.Component{constructor(){super(...arguments);o(this,"state",{show:10,search:"",page:1,pageNumber:1,pageFirst:1,pageSecond:2,pageLast:3});o(this,"inputChangedHandler",a=>{const{name:s,value:n}=a.target,{page:l,show:c,search:r}=this.state;if(this.firstPageHandler(),s==="show")return this.props.get(l,n,r),this.setState({show:n});if(s==="search")return y&&clearTimeout(y),y=setTimeout(()=>{this.props.get(l,c,n),clearTimeout(y)},1e3),this.setState({search:n})});o(this,"previousPageHandler",()=>{const{page:a}=this.state;a<=1||this.pageChangeHandler(a-1)});o(this,"nextPageHandler",()=>{const{page:a,pageNumber:s}=this.state;a>=s||this.pageChangeHandler(a+1)});o(this,"firstPageHandler",()=>{const{page:a}=this.state;a<=1||this.pageChangeHandler(1)});o(this,"lastPageHandler",()=>{const{page:a,pageNumber:s}=this.state,n=s;a>=n||this.pageChangeHandler(n)});o(this,"pageChangeHandler",a=>{const{show:s,search:n,pageNumber:l}=this.state,c=l;let r;a<3?r=1:a===c?r=c-2:r=a-1;const d=r+1,N=r+2;this.setState({page:a,pageFirst:r,pageSecond:d,pageLast:N},()=>this.props.get(a,s,n))});o(this,"onClick",a=>{a.preventDefault();const s=a.target.href;this.exportData(s)});o(this,"exportData",async a=>{const{data:s,title:n}=this.props,l=a.split("/")[a.split("/").length-1],c=n+"."+l,r=localStorage.getItem("token");try{const d=new FormData;d.append("data",s),d.append("name",c);const v=await(await fetch(a,{method:"POST",mode:"cors",body:d,headers:{Authorization:r}})).blob(),k=URL.createObjectURL(v),u=document.createElement("a");u.style.display="none",u.href=k,u.download=c,document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(k)}catch(d){console.log(d)}})}componentDidMount(){const{total:a}=this.props,{show:s}=this.state;this.setState({pageNumber:Math.ceil(a/s)})}componentDidUpdate(a,s){const{total:n}=this.props,{show:l}=this.state;(a.total!==n||s.show!==l)&&this.setState({pageNumber:Math.ceil(n/l)})}render(){const{fields:a,array:s,loading:n=!1,total:l=0,limit:c,bordered:r,title:d,subtitle:N,add:v,link:k,dark:u=!1,borderless:U,outerClassName:A="",select:D,children:F,selectHandler:O,content:{cms:{pages:{backend:{components:{list:i}}}}}}=this.props,{show:f,search:I,page:m,pageFirst:x,pageSecond:H,pageLast:P,pageNumber:C}=this.state,L=a.map(({name:b,fixed:g})=>e("th",{className:"text-nowrap"+(g?" sticky":""),style:g?{position:"sticky",right:0}:{},children:b},b));L.unshift(e("th",{className:"sl",children:i.sl},"#")),D&&L.unshift(e("th",{children:e("input",{type:"checkbox",onClick:O,className:"select_all"})},"select_all"));const M=s.map((b,g)=>{if(c&&g>=c)return null;let S=[e("th",{className:"sl",children:(f==="All"?0:(m-1)*f)+g+1},"primary"+g)];return D&&S.unshift(e("th",{children:e("input",{type:"checkbox",value:b._id})},"secondary"+g)),a.forEach(({key:R,minWidth:$,fixed:z,className:B=""})=>{S.push(e("td",{className:B,style:J({minWidth:$,maxWidth:250},z?{position:"sticky",right:0}:{}),children:b[R]},R))}),e("tr",{className:"align-middle",children:S},g+1)}),_=t(w,{children:[t("div",{className:"show",children:[e("div",{className:"text",children:i.show}),t(T,{type:"select",name:"show",onChange:this.inputChangedHandler,className:"select",children:[e("option",{value:"10",children:"10"}),e("option",{value:"25",children:"25"}),e("option",{value:"50",children:"50"}),e("option",{value:"100",children:"100"}),e("option",{value:"All",children:i.all})]})]}),t(K,{className:"export",children:[t(Q,{color:"blue",caret:!0,children:[e("i",{className:"fas fa-file-export"}),"Export"]}),t(V,{children:[t("a",{href:"/api/export/xlsx",onClick:this.onClick,className:"dropdown-item",children:[e("i",{className:"fas fa-file-excel"}),i.excel]}),t("a",{href:"/api/export/pdf",onClick:this.onClick,className:"dropdown-item",children:[e("i",{className:"fas fa-file-pdf"}),i.pdf]}),t("a",{href:"/api/export/csv",onClick:this.onClick,className:"dropdown-item",children:[e("i",{className:"fas fa-file-csv"}),i.csv]}),t("a",{href:"/api/export/pdf",onClick:this.onClick,className:"dropdown-item",children:[e("i",{className:"fas fa-print"}),i.print]})]})]}),e("div",{className:"search",children:e(T,{type:"search",name:"search",onChange:this.inputChangedHandler,placeholder:`${i.search}...`})}),v&&e(X,{to:k,className:"link",children:t("button",{className:"btn btn-blue",children:[e("span",{children:v}),e("i",{className:"fas fa-plus"})]})})]}),j=l%f,E=l===0?l:j!==0?j:f;return t("div",{className:"UI List shadow "+A,children:[e("input",{type:"hidden",id:"table-show",value:f}),e("input",{type:"hidden",id:"table-page",value:m}),e("input",{type:"hidden",id:"table-search",value:I}),t("div",{className:"header",children:[t("div",{children:[e("div",{className:"title",children:d}),e("div",{className:"subtitle",children:N}),e("div",{className:"bold-line"})]}),_]}),t("div",{className:"body",children:[t("div",{className:`table-responsive scrollbar-${window.APP_PRIMARY_COLOR}`,children:[t(Z,{dark:u,bordered:r,hover:!0,borderless:U,children:[e("thead",{className:"title",children:e("tr",{children:L})}),e("tbody",{children:!n&&M})]}),n&&t("div",{className:"loading",children:[i.loading,"..."]})]}),e("div",{children:F}),t("div",{children:[t("div",{children:[i.showing," ",+m<C?f:E," ",i.from," ",l," ",l>1?i.entries.plural:i.entries.singular,"."]}),e("div",{className:"pt-2 d-flex justify-content-end",children:f!=="All"&&t("ul",{className:"pagination btn-group",children:[m!==1&&t(w,{children:[t("li",{className:"btn btn-yellow",onClick:this.firstPageHandler,children:[e("i",{className:"fas fa-angle-double-left mr-2"}),i.first]}),e("li",{className:"btn btn-darkblue text-secondary",onClick:this.previousPageHandler,children:e("i",{className:"fas fa-chevron-left"})})]}),e("li",{className:"btn btn-darkblue "+(m===x?"text-700 active":"secondary"),onClick:()=>this.pageChangeHandler(x),children:x}),C>1&&t(w,{children:[e("li",{className:"btn btn-darkblue "+(m===H?"text-700 active":"secondary"),onClick:()=>this.pageChangeHandler(H),children:H}),C>2&&e("li",{className:"btn btn-darkblue "+(m===P?"text-700 active":"secondary"),onClick:()=>this.pageChangeHandler(P),children:P}),m!==C&&t(w,{children:[e("li",{className:"btn btn-darkblue text-secondary",onClick:this.nextPageHandler,children:e("i",{className:"fas fa-chevron-right"})}),t("li",{className:"btn btn-primary",onClick:this.lastPageHandler,children:[i.last,e("i",{className:"fas fa-angle-double-right ml-2"})]})]})]})]})})]})]})]})}}const ae=h=>({...h}),ie=q(ae)(ee);export{ie as L};
//# sourceMappingURL=index-bb759524.js.map
