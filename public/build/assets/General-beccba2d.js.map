{"version":3,"file":"General-beccba2d.js","sources":["../../../resources/ts/src/containers/Backend/Manager/Cms/General.jsx"],"sourcesContent":["import React, { Component, useState } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\n// General\r\nimport Loading from '../../../../components/UI/Preloaders/Loading';\r\n\r\nimport Error from '../../../../components/Messages/Error';\r\nimport Feedback from '../../../../components/Messages/Feedback';\r\n\r\nimport Form from '../../../../components/Backend/UI/Form';\r\nimport PageTitle from '../../../../components/Backend/UI/Title/PageTitle';\r\nimport Breadcrumb from '../../../../components/Backend/UI/Title/Breadcrumb';\r\n\r\nimport Input from '../../../../components/UI/Input';\r\n\r\nimport { getCms, patchCms, resetCms } from '../../../../store/actions/backend/cms';\r\nimport { updateObject } from '../../../../shared/utility';\r\n\r\nconst Separator = ({ sm }) => <div className={`col-12 mb-${sm ? 2 : 3}`} />\r\n\r\nconst Language = ({ general, language }) => {\r\n    const [value, setValue] = useState(general);\r\n\r\n    const onChange = (e, ...deepness) => {\r\n        const valueCopy = { ...value };\r\n\r\n        if (deepness.length === 1) {\r\n            valueCopy[deepness[0]] = e.target.value;\r\n            return setValue(valueCopy);\r\n        }\r\n\r\n        const subValues = [];\r\n        let subValue = { ...value };\r\n        for (let i = 0; i < deepness.length - 1; i++) {\r\n            const element = deepness[i];\r\n            subValue = subValue[element];\r\n            subValues.push(subValue);\r\n        }\r\n        subValues[subValues.length - 1][deepness[deepness.length - 1]] = e.target.value;\r\n        for (let i = 1; i < deepness.length - 1; i++) {\r\n            const element = deepness[deepness.length - 1 - i];\r\n            const index = subValues.length - 1 - i;\r\n            subValues[index][element] = subValues[index + 1];\r\n        }\r\n        valueCopy[deepness[0]] = subValues[0];\r\n\r\n        setValue(valueCopy);\r\n    }\r\n\r\n    const prefix = `${language.abbr}[general]`;\r\n    const prefixId = `${language.abbr}-general`;\r\n    const global = ['Date', 'Time', 'Home'].map(item => <Input key={Math.random()} type=\"text\" className=\"col-md-6 col-lg-4\" id={`${prefixId}-${item.toLowerCase()}`} name={`${prefix}[${item.toLowerCase()}]`} label={item} onChange={e => onChange(e, item.toLowerCase())} value={value[item.toLowerCase()]} />);\r\n    const weekDays = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"].map((item, index) => <Input key={Math.random()} type=\"text\" className=\"col-md-6 col-lg-4\" id={`${prefixId}-date-${index}`} name={`${prefix}[days][]`} label={item} onChange={e => onChange(e, 'days', index)} value={value.days[index]} />);\r\n    const months = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"].map((item, index) => <Input key={Math.random()} type=\"text\" className=\"col-md-6 col-lg-4\" id={`${prefixId}-months-${index}`} name={`${prefix}[months][]`} label={item} onChange={e => onChange(e, 'months', index)} value={value.months[index]} />);\r\n\r\n    return <div className='row'>\r\n        {global}\r\n        <Separator />\r\n\r\n        <div className='col-12'>\r\n            <h4>Week days</h4>\r\n        </div>\r\n        <Separator sm />\r\n        {weekDays}\r\n        <Separator />\r\n\r\n        <div className='col-12'>\r\n            <h4>Months</h4>\r\n        </div>\r\n        <Separator sm />\r\n        {months}\r\n    </div>;\r\n};\r\n\r\nclass General extends Component {\r\n    state = {\r\n        abbr: import.meta.env.VITE_DEFAULT_LANG,\r\n        isMounted: false,\r\n    }\r\n\r\n    static getDerivedStateFromProps(nextProps, prevState) {\r\n        if (nextProps.backend.cms.cms && prevState.app_name === '') {\r\n            const { backend: { cms: { cms: { general } } } } = nextProps;\r\n            return updateObject(prevState, { ...general });\r\n        }\r\n        return prevState;\r\n    }\r\n\r\n    async componentDidMount() {\r\n        this.props.reset();\r\n        this.props.get();\r\n        this.setState({ isMounted: true });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.reset();\r\n    }\r\n\r\n    submitHandler = async e => {\r\n        e.preventDefault();\r\n        await this.props.patch(e.target);\r\n    }\r\n\r\n    inputChangeHandler = e => {\r\n        const { name, value, files } = e.target;\r\n        this.setState({ [name]: files ? files[0] : value });\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            content: {\r\n                cms: {\r\n                    pages: { backend: { components: { form: { save } }, pages: { cms: { icon, title, general } } } }\r\n                }\r\n            },\r\n            backend: { cms: { loading, error, message, cms, languages = [] } },\r\n            auth: { role }\r\n        } = this.props;\r\n        const { abbr } = this.state;\r\n\r\n        if (!this.state.isMounted) document.title = `${this.props.content.cms.pages.backend.sidebar.menu.cms.general} | ${document.head.querySelector('meta[name=\"base-title\"]').content}`;\r\n\r\n        const errors = <Error err={error} />;\r\n\r\n        const languagesOptions = languages.map(language => <option key={Math.random() + JSON.stringify(language)} value={language.abbr}>{language.name}</option>);\r\n\r\n        const mainContent = languages.map(language => <div key={Math.random()} className={language.abbr === abbr ? \"\" : \"d-none\"}>\r\n            <Language general={cms.pages[language.abbr].general} language={language} />\r\n        </div>);\r\n\r\n        const content = <div>\r\n            <Feedback message={message} />\r\n\r\n            <input type=\"hidden\" name=\"_method\" defaultValue=\"PATCH\" />\r\n\r\n            <div className='row'>\r\n                <div className=\"col-md-4\">\r\n                    <Input type=\"select\" name=\"abbr\" label={'Lang'} onChange={this.inputChangeHandler} value={abbr}>\r\n                        {languagesOptions}\r\n                    </Input>\r\n                </div>\r\n            </div>\r\n\r\n            <hr />\r\n\r\n            <div>{mainContent}</div>\r\n\r\n            <div style={{ marginTop: 40 }}>\r\n                <button className={`btn btn-${window.APP_PRIMARY_COLOR}`}>{save}<i className='fas fa-save' /></button>\r\n            </div>\r\n        </div>;\r\n\r\n\r\n        return <div className='Cms General'>\r\n            <PageTitle title={title} subtitle={general} icon={icon}>\r\n                <Breadcrumb main={general} />\r\n            </PageTitle>\r\n\r\n            <Loading loading={this.state.isMounted && loading} isAuthenticated>\r\n                <div className='content'>\r\n                    {errors}\r\n                    <Form onSubmit={this.submitHandler} icon={icon} title={general} link={`/${role}/cms`}>\r\n                        {content}\r\n                    </Form>\r\n                </div>\r\n            </Loading>\r\n        </div>;\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => ({ ...state });\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    get: () => dispatch(getCms()),\r\n    patch: data => dispatch(patchCms('general', data)),\r\n    reset: () => dispatch(resetCms()),\r\n});\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(General));"],"names":["Separator","sm","jsx","Language","general","language","value","setValue","useState","onChange","e","deepness","valueCopy","subValues","subValue","element","index","prefix","prefixId","global","Input","item","weekDays","months","jsxs","General","Component","__publicField","name","files","nextProps","prevState","updateObject","save","icon","title","loading","error","message","cms","languages","role","abbr","errors","Error","languagesOptions","mainContent","content","Feedback","PageTitle","Breadcrumb","Loading","Form","mapStateToProps","state","mapDispatchToProps","dispatch","getCms","data","patchCms","resetCms","General$1","withRouter","connect"],"mappings":"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"}